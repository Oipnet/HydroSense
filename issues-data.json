{
  "issues": [
    {
      "epic": "EPIC-1",
      "number": 1,
      "title": "[EPIC-1] Initialiser le monorepo",
      "labels": ["epic:setup", "infra"],
      "body": "## Description\n\nCréer la structure de base du monorepo avec les dossiers backend, frontend et infra.\n\n## Objectif\n\n- Avoir un monorepo propre pour HydroSense, avec une structure claire.\n\n## Tâches\n\n- [ ] Créer les dossiers `backend/`, `frontend/`, `infra/`.\n- [ ] Ajouter un `.gitignore` à la racine.\n- [ ] Ajouter un `README.md` à la racine décrivant brièvement le projet.\n\n## Acceptance criteria\n\n- [ ] Le dépôt contient les trois dossiers.\n- [ ] Le README racine décrit le projet et la structure.\n- [ ] Le `.gitignore` couvre au minimum les artefacts PHP, Node, et les dossiers de build."
    },
    {
      "epic": "EPIC-2",
      "number": 2,
      "title": "[EPIC-2] Initialiser backend Symfony + API Platform",
      "labels": ["epic:backend", "backend"],
      "body": "## Description\n\nInstaller Symfony 7, API Platform et la base de config pour l'API.\n\n## Objectif\n\n- Avoir un projet Symfony 7 avec API Platform installé dans `/backend`.\n\n## Tâches\n\n- [ ] Créer un projet Symfony 7 dans `/backend`.\n- [ ] Installer API Platform.\n- [ ] Installer et configurer le bundle JWT (LexikJWT).\n- [ ] Configurer CORS pour autoriser les appels depuis le frontend Nuxt.\n- [ ] Ajouter un README spécifique au backend.\n\n## Acceptance criteria\n\n- [ ] L'URL `/api` affiche l'interface API Platform.\n- [ ] Le bundle JWT est installé et configuré.\n- [ ] La configuration CORS permet au frontend d'appeler l'API en dev."
    },
    {
      "epic": "EPIC-2",
      "number": 3,
      "title": "[EPIC-2] User + Authentification JWT",
      "labels": ["epic:backend", "backend"],
      "body": "## Description\n\nCréer l'entité User et la mécanique de login JWT.\n\n## Objectif\n\n- Permettre à un utilisateur de se connecter et de récupérer son profil.\n\n## Tâches\n\n- [ ] Créer l'entité `User` (id, email, password, roles, name).\n- [ ] Configurer le password hasher.\n- [ ] Créer l'endpoint `/api/auth/login` qui retourne un JWT.\n- [ ] Créer l'endpoint `/api/me` qui renvoie les infos de l'utilisateur connecté.\n\n## Acceptance criteria\n\n- [ ] Un user peut se connecter avec email/password.\n- [ ] Un token JWT est retourné au login.\n- [ ] `GET /api/me` retourne bien l'utilisateur connecté."
    },
    {
      "epic": "EPIC-2",
      "number": 4,
      "title": "[EPIC-2] Entités Farm & Reservoir",
      "labels": ["epic:backend", "backend"],
      "body": "## Description\n\nGérer les exploitations et les bacs nutriments.\n\n## Objectif\n\n- Modéliser les fermes et les réservoirs liés à un utilisateur.\n\n## Tâches\n\n- [ ] Créer l'entité `Farm` (id, name, owner=User).\n- [ ] Créer l'entité `Reservoir` (id, name, volumeLiters, createdAt, relation à Farm).\n- [ ] Ajouter les annotations `ApiResource` sur `Farm` et `Reservoir`.\n- [ ] Ajouter la sécurité : un user ne peut voir que ses farms et reservoirs.\n\n## Acceptance criteria\n\n- [ ] CRUD API Platform fonctionnel pour Farm et Reservoir.\n- [ ] Un utilisateur ne peut ni lire ni modifier les farms/reservoirs d'un autre user."
    },
    {
      "epic": "EPIC-2",
      "number": 5,
      "title": "[EPIC-2] Entité CultureProfile (référentiel)",
      "labels": ["epic:backend", "backend"],
      "body": "## Description\n\nCréer un référentiel de profiles de culture (plages pH, EC, etc.).\n\n## Objectif\n\n- Fournir des profiles de plantes avec plages idéales pour l'analyse future.\n\n## Tâches\n\n- [ ] Créer l'entité `CultureProfile` (name, phMin, phMax, ecMin, ecMax, waterTempMin, waterTempMax).\n- [ ] Ajouter `ApiResource` en lecture seule.\n- [ ] Ajouter des fixtures pour plusieurs cultures (laitue, basilic, fraises, micro-pousses, etc.).\n\n## Acceptance criteria\n\n- [ ] `GET /api/culture_profiles` retourne une liste de profiles.\n- [ ] Les champs min/max sont correctement typés et exposés."
    },
    {
      "epic": "EPIC-2",
      "number": 6,
      "title": "[EPIC-2] Entité Measurement (mesures pH/EC/temp)",
      "labels": ["epic:backend", "backend"],
      "body": "## Description\n\nEnregistrer les mesures manuelles ou importées par réservoir.\n\n## Objectif\n\n- Stocker les mesures de pH, EC et température de l'eau.\n\n## Tâches\n\n- [ ] Créer l'entité `Measurement` (reservoir, measuredAt, ph, ec, waterTemp, source).\n- [ ] Exposer comme `ApiResource`.\n- [ ] Ajouter un filtre par date (`from`, `to`).\n- [ ] Ajouter un endpoint pour créer une mesure liée à un réservoir.\n\n## Acceptance criteria\n\n- [ ] Les mesures peuvent être créées et lues via l'API.\n- [ ] Le filtrage par période fonctionne."
    },
    {
      "epic": "EPIC-2",
      "number": 7,
      "title": "[EPIC-2] Import CSV des mesures",
      "labels": ["epic:backend", "backend"],
      "body": "## Description\n\nPermettre d'importer des mesures depuis un fichier CSV.\n\n## Objectif\n\n- Importer facilement un historique de mesures pour un réservoir.\n\n## Tâches\n\n- [ ] Créer un endpoint `POST /api/reservoirs/{id}/measurements/import`.\n- [ ] Définir le format CSV (par ex : `measuredAt;ph;ec;waterTemp`).\n- [ ] Parser le fichier et créer des `Measurement`.\n- [ ] Gérer les erreurs de format proprement.\n\n## Acceptance criteria\n\n- [ ] Un fichier CSV valide importe plusieurs mesures.\n- [ ] Les erreurs sont renvoyées avec un message clair."
    },
    {
      "epic": "EPIC-2",
      "number": 8,
      "title": "[EPIC-2] Entité Alert + moteur d'analyse simple",
      "labels": ["epic:backend", "backend"],
      "body": "## Description\n\nGénérer des alertes en fonction des mesures et des plages CultureProfile.\n\n## Objectif\n\n- Créer des alertes automatiques quand une mesure sort des plages définies.\n\n## Tâches\n\n- [ ] Créer l'entité `Alert` (reservoir, type, severity, createdAt, resolvedAt).\n- [ ] Créer un service `AnomalyDetector` qui analyse une Measurement et retourne éventuelles Alert.\n- [ ] Créer un Processor API Platform qui, lors de la création de Measurement, appelle l'`AnomalyDetector` et persiste les Alert nécessaires.\n\n## Acceptance criteria\n\n- [ ] Une mesure hors plage (pH, EC, Temp) génère une alerte.\n- [ ] Les alertes sont accessibles via l'API."
    },
    {
      "epic": "EPIC-2",
      "number": 9,
      "title": "[EPIC-2] Entité JournalEntry (journal de culture)",
      "labels": ["epic:backend", "backend"],
      "body": "## Description\n\nPermettre d'ajouter des notes et photos par réservoir.\n\n## Objectif\n\n- Enregistrer les notes journalières et observations de culture.\n\n## Tâches\n\n- [ ] Créer l'entité `JournalEntry` (reservoir, content, createdAt, photoUrl).\n- [ ] Exposer les endpoints CRUD via API Platform.\n- [ ] Ajouter un mécanisme simple d'upload d'image (local ou S3-like).\n\n## Acceptance criteria\n\n- [ ] Il est possible de créer, lister et supprimer des entrées de journal pour un réservoir.\n- [ ] Le champ photoUrl est rempli lors d'un upload."
    },
    {
      "epic": "EPIC-2",
      "number": 10,
      "title": "[EPIC-2] Endpoint Dashboard (vue synthèse backend)",
      "labels": ["epic:backend", "backend"],
      "body": "## Description\n\nFournir un endpoint de synthèse pour le dashboard global.\n\n## Objectif\n\n- Avoir une route unique renvoyant l'état global de la ferme pour l'utilisateur.\n\n## Tâches\n\n- [ ] Créer un Provider custom API Platform sur `/api/dashboard`.\n- [ ] Retourner : nombre de réservoirs, dernières mesures par réservoir, nombre d'alertes critiques ouvertes.\n\n## Acceptance criteria\n\n- [ ] L'endpoint renvoie un JSON structuré prêt à consommer côté frontend."
    },
    {
      "epic": "EPIC-2",
      "number": 11,
      "title": "[EPIC-2] OpenAPI propre et documenté",
      "labels": ["epic:backend", "backend", "ia"],
      "body": "## Description\n\nNettoyer la spec OpenAPI pour faciliter la génération de client et l'usage par une IA.\n\n## Objectif\n\n- Avoir un OpenAPI 3 propre, complet et bien documenté.\n\n## Tâches\n\n- [ ] Ajouter descriptions et examples sur les ressources principales (User, Farm, Reservoir, Measurement, Alert, JournalEntry).\n- [ ] Vérifier les noms des schémas.\n- [ ] Générer le fichier `openapi.json` exposé publiquement.\n\n## Acceptance criteria\n\n- [ ] Le fichier openapi.json est généré et exploitable.\n- [ ] Les exemples permettent de comprendre rapidement les payloads."
    },
    {
      "epic": "EPIC-3",
      "number": 12,
      "title": "[EPIC-3] Initialiser Nuxt 3 + Tailwind + Pinia",
      "labels": ["epic:frontend", "frontend"],
      "body": "## Description\n\nSetup du frontend Nuxt 3.\n\n## Objectif\n\n- Avoir une base Nuxt 3 fonctionnelle.\n\n## Tâches\n\n- [ ] Créer le projet Nuxt dans `/frontend`.\n- [ ] Ajouter TypeScript.\n- [ ] Ajouter TailwindCSS.\n- [ ] Ajouter Pinia.\n- [ ] Configurer `.env` pour l'URL de l'API backend.\n\n## Acceptance criteria\n\n- [ ] `npm run dev` démarre l'app.\n- [ ] Tailwind et Pinia sont bien fonctionnels."
    },
    {
      "epic": "EPIC-3",
      "number": 13,
      "title": "[EPIC-3] Générer le client API depuis OpenAPI",
      "labels": ["epic:frontend", "frontend"],
      "body": "## Description\n\nUtiliser api-platform/client-generator pour générer le client Nuxt.\n\n## Objectif\n\n- Consommer l'API backend via un client généré automatiquement à partir d'OpenAPI.\n\n## Tâches\n\n- [ ] Utiliser `@api-platform/client-generator` avec le openapi.json du backend.\n- [ ] Générer le client Nuxt (composables, types).\n- [ ] Intégrer le client dans le code (dossier `composables/api` par exemple).\n\n## Acceptance criteria\n\n- [ ] Une requête de test vers `/api/me` fonctionne via le client généré."
    },
    {
      "epic": "EPIC-3",
      "number": 14,
      "title": "[EPIC-3] Auth (login + middleware)",
      "labels": ["epic:frontend", "frontend"],
      "body": "## Description\n\nGérer l'authentification côté Nuxt.\n\n## Objectif\n\n- Permettre à l'utilisateur de se connecter et protéger les routes `/app/*`.\n\n## Tâches\n\n- [ ] Créer la page `/login`.\n- [ ] Créer un store `useAuthStore` pour gérer le JWT.\n- [ ] Ajouter un middleware global qui redirige vers `/login` si non authentifié.\n\n## Acceptance criteria\n\n- [ ] Un utilisateur peut se connecter depuis `/login`.\n- [ ] L'accès à `/app/*` redirige vers `/login` si non connecté."
    },
    {
      "epic": "EPIC-3",
      "number": 15,
      "title": "[EPIC-3] Page Liste des Réservoirs",
      "labels": ["epic:frontend", "frontend"],
      "body": "## Description\n\nLister les réservoirs de l'utilisateur.\n\n## Objectif\n\n- Afficher une liste des réservoirs avec quelques infos clés.\n\n## Tâches\n\n- [ ] Créer la page `/app/reservoirs`.\n- [ ] Récupérer les réservoirs via le client API.\n- [ ] Afficher name, volume, cultureProfile, statut global (OK/WARN/CRIT si possible).\n\n## Acceptance criteria\n\n- [ ] La page liste les réservoirs du user connecté.\n- [ ] Un clic sur un réservoir renvoie vers sa page de détail."
    },
    {
      "epic": "EPIC-3",
      "number": 16,
      "title": "[EPIC-3] Page Détail d'un Réservoir",
      "labels": ["epic:frontend", "frontend"],
      "body": "## Description\n\nPage de détail avec onglets (overview, mesures, alertes, journal).\n\n## Objectif\n\n- Fournir une vue centrale pour un réservoir.\n\n## Tâches\n\n- [ ] Créer la page `/app/reservoirs/[id]`.\n- [ ] Ajouter des onglets : Vue d'ensemble, Mesures, Alertes, Journal.\n- [ ] Charger les données du réservoir via le client API.\n\n## Acceptance criteria\n\n- [ ] L'URL `/app/reservoirs/{id}` affiche les infos du réservoir et les onglets."
    },
    {
      "epic": "EPIC-3",
      "number": 17,
      "title": "[EPIC-3] Onglet Mesures",
      "labels": ["epic:frontend", "frontend"],
      "body": "## Description\n\nGraphiques et saisie des mesures.\n\n## Objectif\n\n- Visualiser et ajouter des mesures de pH/EC/température.\n\n## Tâches\n\n- [ ] Afficher des graphiques (Chart.js ou équivalent) pour pH, EC, Temp sur une période.\n- [ ] Ajouter un formulaire pour créer une nouvelle measurement.\n- [ ] Ajouter un formulaire d'upload CSV pour import.\n\n## Acceptance criteria\n\n- [ ] Les courbes s'affichent pour les mesures existantes.\n- [ ] Ajouter une mesure met à jour les courbes.\n- [ ] Import CSV ajoute plusieurs mesures."
    },
    {
      "epic": "EPIC-3",
      "number": 18,
      "title": "[EPIC-3] Onglet Alerts",
      "labels": ["epic:frontend", "frontend"],
      "body": "## Description\n\nAffichage et gestion des alertes d'un réservoir.\n\n## Objectif\n\n- Permettre de visualiser et marquer les alertes comme résolues.\n\n## Tâches\n\n- [ ] Lister les alertes pour le réservoir.\n- [ ] Afficher type et severity.\n- [ ] Bouton \"Marquer comme résolue\" qui appelle l'API.\n\n## Acceptance criteria\n\n- [ ] Les alertes s'affichent clairement.\n- [ ] Une alerte peut être marquée comme résolue et disparaît de la liste active."
    },
    {
      "epic": "EPIC-3",
      "number": 19,
      "title": "[EPIC-3] Onglet Journal",
      "labels": ["epic:frontend", "frontend"],
      "body": "## Description\n\nAfficher et créer des entrées de journal.\n\n## Objectif\n\n- Permettre à l'utilisateur de documenter sa culture.\n\n## Tâches\n\n- [ ] Lister les `JournalEntry` liés au réservoir.\n- [ ] Formulaire pour ajouter une nouvelle note (texte + photo optionnelle).\n\n## Acceptance criteria\n\n- [ ] Les notes existantes sont visibles.\n- [ ] Une nouvelle note apparaît après soumission du formulaire."
    },
    {
      "epic": "EPIC-3",
      "number": 20,
      "title": "[EPIC-3] Dashboard global frontend",
      "labels": ["epic:frontend", "frontend"],
      "body": "## Description\n\nPage d'accueil /app/dashboard avec synthèse.\n\n## Objectif\n\n- Avoir une vue d'ensemble de l'état de la ferme pour l'utilisateur.\n\n## Tâches\n\n- [ ] Créer la page `/app/dashboard`.\n- [ ] Consommer l'endpoint `/api/dashboard`.\n- [ ] Afficher nombre de réservoirs, alertes critiques, dernières mesures.\n\n## Acceptance criteria\n\n- [ ] Le dashboard affiche les données de synthèse et se charge sans erreur."
    },
    {
      "epic": "EPIC-4",
      "number": 21,
      "title": "[EPIC-4] Docker Compose backend + Postgres",
      "labels": ["epic:infra", "infra"],
      "body": "## Description\n\nFournir un environnement Docker pour le backend.\n\n## Objectif\n\n- Simplifier le setup backend avec Docker.\n\n## Tâches\n\n- [ ] Créer un `docker-compose.yml` avec services : PHP/Symfony, Postgres, Adminer (optionnel).\n- [ ] Documenter dans le README backend comment lancer l'environnement.\n\n## Acceptance criteria\n\n- [ ] `docker compose up` démarre l'API Symfony et la base de données."
    },
    {
      "epic": "EPIC-4",
      "number": 22,
      "title": "[EPIC-4] Dockerfile de build Nuxt 3 (production)",
      "labels": ["epic:infra", "infra"],
      "body": "## Description\n\nPermettre de builder et servir le frontend Nuxt en production.\n\n## Objectif\n\n- Avoir une image Docker pour servir le frontend en mode prod.\n\n## Tâches\n\n- [ ] Créer un Dockerfile multi-stage pour Nuxt 3 (build + runtime).\n- [ ] Documenter la commande de build et de run.\n\n## Acceptance criteria\n\n- [ ] Une image Docker Nuxt 3 peut être buildée et lancée, et sert l'app correctement."
    },
    {
      "epic": "EPIC-5",
      "number": 23,
      "title": "[EPIC-5] Améliorer descriptions OpenAPI pour usage IA",
      "labels": ["epic:ia", "ia", "backend"],
      "body": "## Description\n\nAdapter la spec OpenAPI pour faciliter la génération de code par IA.\n\n## Objectif\n\n- Rendre les schémas et descriptions auto-explicites pour une IA.\n\n## Tâches\n\n- [ ] Ajouter des descriptions claires aux schémas importants.\n- [ ] Ajouter des examples de requêtes et réponses.\n\n## Acceptance criteria\n\n- [ ] Les principales opérations peuvent être comprises sans lire le code backend."
    },
    {
      "epic": "EPIC-5",
      "number": 24,
      "title": "[EPIC-5] Ajouter docstrings sur Processors & Providers",
      "labels": ["epic:ia", "ia", "backend"],
      "body": "## Description\n\nAjouter de la documentation dans le code pour guider l'IA.\n\n## Objectif\n\n- Faciliter la maintenance assistée par IA.\n\n## Tâches\n\n- [ ] Ajouter des docblocks/docstrings explicites sur les Processors, Providers et services critiques (AnomalyDetector, etc.).\n\n## Acceptance criteria\n\n- [ ] Chaque classe clé a une docstring qui décrit son rôle, ses inputs et ses outputs."
    }
  ]
}
